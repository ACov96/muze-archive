3:mod
3:Scratch
7:type
7:linkedlist
7:(
7:T
7:)
7:=
8:rec
8:{
9:value
9::
9:T
9:;
10:next
10::
10:linkedlist
10:(
10:T
10:)
11:}
13:mu
13:array
13:(
13:T
13:)
14:size
14::
14:integer
14:;
15:temp
15::
15:linkedlist
15:(
15:T
15:)
15:;
17:size
17:=
<0>
17:;
19:temp
19:=
19:linkedlist
19:;
23:loop
24:if
24:temp
24:==
24:Nil
24:then
25:break
26:fi
28:n
28:+=
<1>
28:;
29:temp
29:=
29:temp
29:.
29:next
29:;
30:pool
32:array
32:=
32:new_array
32:(
32:T
32:)
32:(
32:n
32:)
32:;
33:temp
33:=
33:linkedlist
33:;
35:fa
35:i
35:in
$0.$
35:.
35:n
35:do
36:array
36:[
36:i
36:]
36:=
36:temp
36:.
36:value
36:;
37:temp
37:=
37:temp
37:.
37:next
37:;
38:af
39:um
40:epyt
42:fun
42:fibonacci
42:(
42:n
42::
42:integer
42:)
42::
42:array
42:(
42:integer
42:)
43:fun
43:fib_inner
43:(
43:a
43:,
43:b
43:,
43:n
43::
43:integer
43:)
43::
43:linkedlist
43:(
43:integer
43:)
44:ret
44::
44:linkedlist
44:(
44:integer
44:)
44:;
45:ret_copy
45::
45:linkedlist
45:(
45:integer
45:)
45:;
47:if
47:n
47:==
<0>
47:then
49:ret
49::=
49:=
49:rec
49:{
49:a
49:,
49:Nil
49:}
49:;
51:ret
51:=
51:morph
51:rec
51:{
51:a
51:,
51:Nil
51:}
51:;
55:ret_copy
55:::
55:ret
55:;
56:ret_copy
56:=
56:copy
56:ret
56:;
59:ret_copy
59::=
59:=
59:ret
59:;
60:else
61:ret
61::=
61:=
61:rec
61:{
61:a
61:,
61:fib_inner
61:(
61:b
61:,
61:a
61:+
61:b
61:,
61:n
61:-
<1>
61:)
61:}
62:fi
64:return
64:ret
64:;
65:nuf
67:return
67:fib_inner
67:(
<0>
67:,
<1>
67:,
67:n
67:)
67:;
68:nuf
70:type
70:fahrenheit
70:=
70:integer
71:epyt
73:type
73:celsius
73:=
73:integer
74:mu
74:bijective
74:fahrenheit
75:fahrenheit
75:=
<5>
75:/
<9>
75:*
75:celsius
75:+
<32>
75:;
76:um
77:epyt
79:a
79::
79:fahrenheit
79:;
80:b
80::
80:celsius
80:;
82:a
82::=
82:=
<10>
82:;
83:a
83:=
<10>
83:;
85:b
85::=
85:=
85:a
85:;
89:type
89:celsius
89:=
89:integer
90:epyt
92:fun
92:inc
92:(
92:x
92::
92:integer
92:)
93:x
93:=
93:x
93:+
<1>
93:;
94:nuf
96:a
96::
96:celsius
96:;
97:a
97::=
97:=
<1>
97:;
99:inc
99:(
99:a
99:)
99:;
100:dom

