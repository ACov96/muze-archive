3:mod
3:Scratch
5:type
5:linkedlist
5:(
5:T
5:)
5:=
6:rec
6:{
7:value
7::
7:T
7:;
8:next
8::
8:linkedlist
8:(
8:T
8:)
9:}
11:mu
11:array
11:(
11:T
11:)
12:size
12::
12:integer
12:;
13:temp
13::
13:linkedlist
13:(
13:T
13:)
13:;
15:size
15:=
<0>
15:;
18:temp
18:=
18:linkedlist
18:;
21:loop
22:if
22:temp
22:==
22:Nil
22:then
23:break
24:fi
26:n
26:+=
<1>
26:;
27:temp
27:=
27:temp
27:.
27:next
27:;
28:pool
31:array
31:=
31:new_array
31:(
31:T
31:)
31:(
31:n
31:)
31:;
32:temp
32:=
32:linkedlist
32:;
35:fa
35:i
35:in
$0.$
35:.
35:n
35:do
36:array
36:[
36:i
36:]
36:=
36:temp
36:.
36:value
36:;
37:temp
37:=
37:temp
37:.
37:next
37:;
38:af
39:um
40:epyt
42:fun
42:fibonacci
42:(
42:n
42::
42:integer
42:)
42::
42:array
42:(
42:integer
42:)
43:fun
43:fib_inner
43:(
43:a
43:,
43:b
43:,
43:n
43::
43:integer
43:)
43::
43:linkedlist
43:(
43:integer
43:)
44:ret
44::
44:linkedlist
44:(
44:integer
44:)
44:;
45:ret_copy
45::
45:linkedlist
45:(
45:integer
45:)
45:;
47:if
47:n
47:==
<0>
47:then
49:ret
49::=
49:=
49:rec
49:{
49:a
49:,
49:Nil
49:}
49:;
51:ret
51:=
51:morph
51:rec
51:{
51:a
51:,
51:Nil
51:}
51:;
54:ret_copy
54:::
54:ret
54:;
55:ret_copy
55:=
55:copy
55:ret
55:;
58:ret_copy
58::=
58:=
58:ret
58:;
59:else
60:ret
60::=
60:=
60:rec
60:{
60:a
60:,
60:fib_inner
60:(
60:b
60:,
60:a
60:+
60:b
60:,
60:n
60:-
<1>
60:)
60:}
61:fi
63:return
63:ret
63:;
64:nuf
67:return
67:fib_inner
67:(
<0>
67:,
<1>
67:,
67:n
67:)
67:;
68:nuf
70:type
70:fahrenheit
70:=
70:integer
71:epyt
73:type
73:celsius
73:=
73:integer
78:mu
78:bijective
78:fahrenheit
79:fahrenheit
79:=
<5>
79:/
<9>
79:*
79:celsius
79:+
<32>
79:;
80:um
81:epyt
83:a
83::
83:fahrenheit
83:;
84:b
84::
84:celsius
84:;
87:a
87::=
87:=
<10>
87:;
89:a
89:=
<10>
89:;
91:b
91::=
91:=
91:a
91:;
97:type
97:celsius
97:=
97:integer
98:epyt
100:fun
100:inc
100:(
100:x
100::
100:integer
100:)
101:x
101:=
101:x
101:+
<1>
101:;
102:nuf
104:a
104::
104:celsius
104:;
105:a
105::=
105:=
<1>
105:;
110:inc
110:(
110:a
110:)
110:;
111:dom

